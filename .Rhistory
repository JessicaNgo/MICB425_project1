library(tidyverse)
library(phyloseq)
library(magrittr)
q.norm %>%
subset_taxa(Phylum=="D_1__Cyanobacteria")
library(tidyverse)
load("qiime2_phyloseq.RData")
qiime2
qiime2_percent = transform_sample_counts(qiime2, function(x) 100 * x/sum(x))
plot_bar(qiime2_percent, fill="Phylum") +
geom_bar(aes(fill=Phylum), stat="identity") +
facet_wrap(~Phylum, scales="free_y") +
theme(legend.position="none")
library(phyloseq)
library(tidyverse)
load("mothur_phyloseq.RData")
mothur
mothur_percent = transform_sample_counts(mothur, function(x) 100 * x/sum(x))
plot_bar(mothur_percent, fill="Phylum") +
geom_bar(aes(fill=Phylum), stat="identity") +
facet_wrap(~Phylum, scales="free_y") +
theme(legend.position="none")
# mothur data
set.seed(4832)
m.norm = rarefy_even_depth(mothur, sample.size=100000)
m.perc = transform_sample_counts(m.norm, function(x) 100 * x/sum(x))
# qiime2 data
set.seed(4832)
q.norm = rarefy_even_depth(qiime2, sample.size=100000)
q.perc = transform_sample_counts(q.norm, function(x) 100 * x/sum(x))
q.norm %>%
subset_taxa(Phylum=="D_1__Cyanobacteria")
q.norm %>%
subset_taxa(Phylum=="D_1__Cyanobacteria")%>%
estimate_richness(measures = c("Observed"))
tax_qiime=data.frame(qiime2@tax_table)
tax_qiime%>%
filter(Phylum=="Cyanobacteria")%>%
count()
tax_qiime%>%
filter(Phylum=="D_1__Cyanobacteria")%>%
count()
m.norm %>%
subset_taxa(Phylum=="Cyanobacteria")
m.norm %>%
subset_taxa(Phylum=="Cyanobacteria")%>%
estimate_richness(measures = c("Observed"))
q.norm %>%
subset_taxa(Phylum=="D_1__Cyanobacteria")
q.norm %>%
subset_taxa(Phylum=="D_1__Cyanobacteria")%>%
estimate_richness(measures = c("Observed"))
